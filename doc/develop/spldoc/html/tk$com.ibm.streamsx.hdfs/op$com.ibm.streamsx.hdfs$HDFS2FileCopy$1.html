<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Examples"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_page"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>Examples</title>
</head>
<body id="spldoc_page">


<h1 class="title topictitle1">Examples </h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">IBMStreams com.ibm.streamsx.hdfs Toolkit</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.hdfs.html">com.ibm.streamsx.hdfs 4.5.0</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.hdfs.html">com.ibm.streamsx.hdfs</a> &gt; <a class="xref" href="op$com.ibm.streamsx.hdfs$HDFS2FileCopy.html">HDFS2FileCopy</a> &gt; Examples </p>

</div>


<div class="section">
<p class="p">This example copies the file test.txt from local path ./data/ into /user/hdfs/ directory. 
</p>

<div class="p">
<pre class="pre codeblock">
streams&lt;boolean succeed&gt; copyFromLocal =  HDFS2FileCopy()
{

    param
        localFile                : "test.txt"; 
        hdfsFile                 : "/user/hdfs/test.txt"; 
        deleteSourceFile         : false; 
        overwriteDestinationFile : true; 
        direction                : copyFromLocalFile
}
</pre>


</div>

<div class="p">This example copies all files from local path /tmp/work into /user/hdfs/work directory. 
<pre class="pre codeblock">
// DirectoryScan operator with an absolute file argument and a file name pattern 
stream&lt;rstring localFile&gt; DirScan = DirectoryScan() 
{  
    param 
        directory       : "/tmp/work"; 
        initDelay       : 1.0; 
} 

// copies all incoming files from input port into /user/hdfs/work directory. 
stream&lt;rstring message, uint64 elapsedTime&gt; lineSink1 = HDFS2FileCopy(DirScan)
{ 
    param
          hdfsUser                 : "hdfs"; 
          hdfsFile                 : "/user/hdfs/work/"; 
          deleteSourceFile         : false; 
          overwriteDestinationFile : true; 
          direction                : copyFromLocalFile; 
          localFileAttrName        : "localFile"; 
}
</pre>


</div>

<p class="p">This example copies all files from HDFS directory <tt class="ph tt">/user/hdfs/work</tt> into local directory <tt class="ph tt">/tmp/work2</tt> . 
</p>

<div class="p">
<ul class="ul">
<li class="li"> 1- copy the kerberos keytab file of your hdfs user from  HDFS server into etc directory. </li>

<li class="li"> 2- Replace the kerberos principal with your hdsf principal. </li>

<li class="li"> 3- Copy the <tt class="ph tt">core-site.xml</tt> file from your HDFS server into <tt class="ph tt">etc</tt> directory. </li>

<li class="li"> 4- Copy the kerberos configuration file in <tt class="ph tt">/etc</tt> directory of your streams server. </li>

</ul>

</div>

<div class="p"><tt class="ph tt">HDFS2DirectoryScan</tt> operator with an absolute directory argument and the kerberos authentication parameters. 
<pre class="pre codeblock">
stream&lt;rstring hdfsFile&gt; HdfsDirScan = HDFS2DirectoryScan() 
{  
    param 
        configPath               : "etc1"; 
        authKeytab               : "etc/hdfs.headless.keytab"; 
        authPrincipal            : "hdfs-hdpcluster@HDP2.COM"; 
        vmArg                    : "-Djava.security.krb5.conf=/etc/krb5.conf"; 
        directory                : "/user/hdfs/work"; 
        sleepTime                : 2.0; 
} 
</pre>


</div>

<div class="p"> // copies all incoming HDFS files from input port into /tmp/work2 directory. 
<pre class="pre codeblock">
stream&lt;rstring message, uint64 elapsedTime&gt; CopyToLocal = HDFS2FileCopy(HdfsDirScan) 
{ 
    param
        authKeytab               : "etc/hdfs.headless.keytab"; 
        authPrincipal            : "hdfs-hdpcluster@HDP2.COM"; 
        configPath               : "etc1"; 
        vmArg                    : "-Djava.security.krb5.conf=/etc/krb5.conf"; 
        hdfsFileAttrName         : "hdfsFile"; 
        deleteSourceFile         : false; 
        overwriteDestinationFile : true; 
        direction                : copyToLocalFile; 
        localFile                : "/tmp/work2"; 
}
</pre>


</div>

</div>

</div>


</body>
</html>